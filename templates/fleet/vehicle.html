<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
        crossorigin="anonymous">

  <title>{{ vehicle_name }}</title>
</head>

<body style="overflow-y:scroll;">

  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
      <li class="breadcrumb-item"><a href="{% url 'station fleet' station_id %}">{{ station_name }}</a></li>
      <li class="breadcrumb-item active" aria-current="page">{{ vehicle_name }}</li>
    </ol>
  </nav>

  <form>
    <div class="accordion" id="bags_accordion">

      {% for vehicle_bag in vehicle_bags %}
        <div class="card">

          <div class="card-header" id="heading{{ vehicle_bag.bag.pk }}">
            <h2 class="mb-0">
              <button class="btn btn-link collapsed"
                      type="button"
                      data-toggle="collapse"
                      data-target="#collapse{{ vehicle_bag.bag.pk }}"
                      aria-expanded="true"
                      aria-controls="collapse{{ vehicle_bag.bag.pk }}">
                {{ vehicle_bag.bag.name }} - {{ vehicle_bag.quantity }} (ea)
              </button>
            </h2>
          </div> {# /card-header #}

          <div id="collapse{{ vehicle_bag.bag.pk }}"
                   class="collapse"
                   aria-labelledby="heading{{ vehicle_bag.bag.pk }}"
                   data-parent="#bags_accordion">

            <div class="card-body">
              <div class="row">
                <div class="col-md-3 col-sm-6">

                  {% for bag_compartment in vehicle_bag.bag.bagcompartment_set.all %}
                    <div class="text-center mb-1" style="background-color:lightgrey;">
                      {{ bag_compartment.name }}
                    </div>

                    {% for item in bag_compartment.bagcompartmenttoitemassociation_set.all %}
                      <div class="form-group row mb-0">

                        <div class="col-sm-2">
                          <input type="text"
                                 class="form-control form-control-sm"
                                 id="input{{ item.pk }}"
                                 placeholder="">
                        </div>

                        {# TODO use extend for them item block below x3 #}
                        <div class="col-sm-10 pl-0">
                          <label for="input{{ item.pk }}" class="col-form-label col-form-label">
                            {{ item.quantity }}x {{ item.item.name }}
                            {% if item.item.size %}, {{ item.item.size }}{% endif %}
                            {% if item.item.notes %}({{ item.item.notes }}){% endif %}
                            {% if item.item.brand %}by {{ item.item.brand }}{% endif %}
                          </label>
                        </div>

                      </div> {# /form-group #}
                    {% endfor %}

                    {% for kit in bag_compartment.kit_set.all %}
                      <div class="row pt-1">
                        <div class="col-12 text-center">
                          {{ kit.name }}
                        </div>
                      </div>

                        {% for item in kit.kittoitemassociation_set.all %}
                          <div class="form-group row mb-0">

                            <div class="col-sm-2">
                              <input type="text"
                                     class="form-control form-control-sm"
                                     id="input{{ item.item.pk }}"
                                     placeholder="">
                            </div>

                            <div class="col-sm-10 pl-0">
                              <label for="input{{ item.item.pk }}" class="col-form-label col-form-label">
                                {{ item.quantity }}x {{ item.item.name }}
                                {% if item.item.size %}, {{ item.item.size }}{% endif %}
                                {% if item.item.notes %}({{ item.item.notes }}){% endif %}
                                {% if item.item.brand %}by {{ item.item.brand }}{% endif %}
                              </label>
                            </div>

                          </div> {# /form-group #}
                        {% endfor %}

                          {% for kit_compartment in kit.kitcompartment_set.all %}
                            <div class="row pt-3 mb-1">
                              <div class="col-12 mt-n3 text-center text-secondary">
                                {{ kit_compartment.name }}
                              </div>
                            </div>

                              {% for item in kit_compartment.kitcompartmenttoitemassociation_set.all %}
                                <div class="form-group row mb-0">

                                  <div class="col-sm-2">
                                    <input type="text"
                                           class="form-control form-control-sm"
                                           id="input{{ item.pk }}" placeholder="">
                                  </div>

                                  <div class="col-sm-10 pl-0">
                                    <label for="input{{ item.pk }}" class="col-form-label col-form-label">
                                      {{ item.quantity }}x {{ item.item.name }}
                                      {% if item.item.size %}, {{ item.item.size }}{% endif %}
                                      {% if item.item.notes %}({{ item.item.notes }}){% endif %}
                                      {% if item.item.brand %}by {{ item.item.brand }}{% endif %}
                                    </label>
                                  </div>

                                </div> {# /form-group #}
                              {% endfor %}

                              {% if kit_compartment.name in new_column_cutoffs %}
                                  </div>
                                  <div class="col-md-3 col-sm-6">
                              {% endif %}

                          {% endfor %}  <!-- /kit>kit_compartment -->
                      {% endfor %}  <!-- /kit -->

                    {% if bag_compartment.name  in new_column_cutoffs %}
                      </div>
                      <div class="col-md-3 col-sm-6">
                    {% endif %}

                  {% endfor %} <!-- /bag_compartment -->

                </div>  {# /col #}
              </div>  {# /row #}
            </div>  {# card-body #}

          </div>  {# collapse #}

        </div> {# /card #}

      {% endfor %}  {# /bag in bags #}
    </div> {# /accordion #}

      <div class="row mt-2 justify-content-center">
        <div class="col-md-2">
          <button type="button" class="btn btn-primary btn-block">Order</button>
        </div>
      </div>

  </form>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
          integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
          crossorigin="anonymous">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
          integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
          crossorigin="anonymous">
  </script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
          integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
          crossorigin="anonymous">
  </script>
</body>
</html>